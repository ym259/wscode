/* CustomDocEditor Styles */

/* Ensure text color is black by default inside the editor to fix dark mode issues */
.ProseMirror {
    outline: none;
    color: black !important;
    /* Font family matches Word's default Japanese font */
    font-family: "Hiragino Mincho ProN", "Hiragino Mincho Pro", "Yu Mincho", "YuMincho", "MS PMincho", "MS Mincho", serif;
    /* Font size from docDefaults (w:sz value), set via CSS variable from PagedEditorContent */
    font-size: var(--doc-default-font-size, 10.5pt);
    /* Line-height from docGrid linePitch, calculated in PagedEditorContent
       Default 1.5 is more appropriate for Japanese documents than 1.15 */
    line-height: var(--doc-default-line-height, 1.5);
    /* Match Word's default letter-spacing (calibrated to 0.015em to force Line 1 wrapping) */
    letter-spacing: 0.015em;
    /* Reset any browser defaults */
    word-spacing: normal;
    /* Preserve leading full-width spaces (e.g. U+3000) from DOCX runs with xml:space="preserve" */
    white-space: pre-wrap;
}

/* =========================
   DOCX Tabs (w:tab + w:tabs)
   ========================= */
.ProseMirror .docx-tab {
    display: inline-block;
    width: 0px; /* computed by TabStopLayout */
    min-width: 0px;
    height: 1em;
    vertical-align: baseline;
}

/* Leader fills (best-effort) */
.ProseMirror .docx-tab[data-leader="dot"] {
    background-image: radial-gradient(currentColor 1px, transparent 1px);
    background-size: 6px 2px;
    background-repeat: repeat-x;
    background-position: left 0.9em;
}

.ProseMirror .docx-tab[data-leader="hyphen"] {
    background-image: repeating-linear-gradient(to right, currentColor 0 6px, transparent 6px 10px);
    background-repeat: repeat-x;
    background-position: left 0.95em;
    background-size: auto 1px;
}

.ProseMirror .docx-tab[data-leader="underscore"] {
    background-image: linear-gradient(currentColor, currentColor);
    background-repeat: repeat-x;
    background-position: left 1.05em;
    background-size: 10px 1px;
}

.ProseMirror p {
    /* Paragraph spacing from docGrid linePitch, simulates Word's grid-based layout
       where consecutive paragraphs have implicit spacing from grid snapping */
    margin-bottom: var(--doc-paragraph-spacing, 3pt);
    margin-top: 0;
    /* Inherit font-size from parent (set via docDefaults) */
}

.ProseMirror h1 {
    font-size: 1em;
    line-height: 1.2;
    font-weight: normal;
    margin-top: 1em;
    margin-bottom: 0.5em;
    color: black !important;
}

.ProseMirror h2 {
    font-size: 1em;
    line-height: 1.2;
    font-weight: normal;
    margin-top: 1em;
    margin-bottom: 0.5em;
    color: black !important;
}

.ProseMirror h3 {
    font-size: 1em;
    line-height: 1.2;
    font-weight: normal;
    margin-top: 1em;
    margin-bottom: 0.5em;
    color: black !important;
}

.ProseMirror h4 {
    font-size: 1em;
    line-height: 1.2;
    font-weight: normal;
    margin-top: 1em;
    margin-bottom: 0.5em;
    color: black !important;
}

.ProseMirror h5 {
    font-size: 1em;
    line-height: 1.2;
    font-weight: normal;
    margin-top: 1em;
    margin-bottom: 0.5em;
    color: black !important;
}

.ProseMirror h6 {
    font-size: 1em;
    line-height: 1.2;
    font-weight: normal;
    margin-top: 1em;
    margin-bottom: 0.5em;
    color: black !important;
}

/* List styles */
.ProseMirror ul,
.ProseMirror ol {
    padding-left: 1.5em;
    margin: 0;
    /* Ensure lists are visible and positioned correctly override any global defaults */
    list-style-position: outside;
    color: black !important;
}

/* When numIndent is explicitly set (via inline style from DocxReader), respect it */
/* Reset default padding so inline style (padding-left) takes full effect */
.ProseMirror ol[data-num-indent-left] {
    padding-left: 0;
    /* Let inline style handle it */
}

/* Special case: when numIndent left is 0 (no indent), ensure no extra padding */
.ProseMirror ol[data-num-indent-left="0"] {
    padding-left: 0 !important;
}

/* Ensure list markers are black */
.ProseMirror li::marker {
    color: black !important;
}

.ProseMirror ul {
    list-style-type: disc !important;
}

.ProseMirror ol {
    list-style-type: decimal;
}

/* Allow inline style from data-num-fmt attribute to override default */
.ProseMirror ol[data-num-fmt] {
    list-style-type: none;
    /* Hide default marker, use custom content */
}

/* ideographTraditional format: （甲）（乙）（丙）... */
.ProseMirror ol[data-num-fmt="ideographTraditional"] {
    counter-reset: ideograph-counter;
}

.ProseMirror ol[data-num-fmt="ideographTraditional"]>li {
    counter-increment: ideograph-counter;
    display: flex;
    align-items: baseline;
}

.ProseMirror ol[data-num-fmt="ideographTraditional"]>li::before {
    content: "（" counter(ideograph-counter, cjk-heavenly-stem) "）";
    white-space: nowrap;
    /* Pull marker left to clear the negative text-indent of the paragraph */
    /* Net width contribution to flex flow = 2.5 + (-4.5) + 2.0 = 0 */
    /* This ensures Line 2 starts at the padding edge, while Marker is left of Line 1 */
    margin-left: -4.5em;
    width: 2.5em;
    margin-right: 2.0em;
    display: inline-block;
    text-align: right;
}

/* ============================================================================
   PARAGRAPH-BASED LIST RENDERING
   List items are rendered as <p> with data-list-* attributes.
   The marker is generated via CSS ::before pseudo-element.
   ============================================================================ */

/* Base styles for all list paragraphs */
.ProseMirror p[data-list-num-id] {
    position: relative;
    /* Inline styles from listIndentHanging provide padding-left */
    /* Inline styles from listIndentLeft provide margin-left */
}

/* === COMMON MARKER STYLES === */
/* All list markers use pre-rendered marker text from listMarkerText attribute */
.ProseMirror p[data-list-num-id]::before {
    content: attr(data-list-marker-text);
    position: absolute;
    /* Position marker's RIGHT edge at the text start (left edge of content after padding) */
    /* left: gutter value, then translateX(-100%) shifts marker left by its own width */
    left: var(--list-gutter, 2.5em);
    transform: translateX(-100%);
    /* Small gap between marker and text */
    padding-right: 0.5em;
    white-space: nowrap;
}

/* Nested ordered lists - Japanese document style numbering */
.ProseMirror ol ol {
    list-style-type: decimal;
}

.ProseMirror ol ol ol {
    list-style-type: cjk-ideographic;
}

.ProseMirror ol ol ol ol {
    list-style-type: hiragana;
}

.ProseMirror ol ol ol ol ol {
    list-style-type: katakana;
}

/* Nested bullet lists */
.ProseMirror ul ul {
    list-style-type: circle;
}

.ProseMirror ul ul ul {
    list-style-type: square;
}

.ProseMirror li {
    margin-bottom: 0.25em;
}

.ProseMirror li p {
    margin-bottom: 0;
}

.ProseMirror li>ol,
.ProseMirror li>ul {
    margin-top: 0.25em;
    margin-bottom: 0.25em;
}



/* Table styles */
.ProseMirror table {
    border-collapse: collapse;
    table-layout: fixed;
    width: 100%;
    margin: 1em 0;
    overflow: hidden;
}

.ProseMirror td,
.ProseMirror th {
    min-width: 1em;
    border: 1px solid #ced4da;
    padding: 3px 5px;
    vertical-align: top;
    box-sizing: border-box;
    position: relative;
}

/* Track Changes Styles */
.track-change-insertion,
.ProseMirror ins {
    color: #1a7f37;
    text-decoration: underline;
    text-decoration-color: #1a7f37;
    background-color: rgba(26, 127, 55, 0.1);
}

.track-change-deletion,
.ProseMirror del {
    color: #cf222e;
    text-decoration: line-through;
    text-decoration-color: #cf222e;
    background-color: rgba(207, 34, 46, 0.1);
}

/* Track Changes Final Mode - shows content as if all changes were accepted */
.track-changes-final-mode .track-change-deletion,
.track-changes-final-mode del {
    display: none !important;
}

.track-changes-final-mode .track-change-insertion,
.track-changes-final-mode ins {
    color: inherit;
    text-decoration: none;
    background-color: transparent;
}

/* Comment Highlight Styles */
.comment-highlight {
    background-color: #fff3cd;
    border-bottom: 2px solid #ffc107;
    padding: 0 2px;
    cursor: pointer;
}

.comment-highlight:hover {
    background-color: #ffe69c;
}

/* Spin animation for loading */
@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

.editorSpinner {
    width: 32px;
    height: 32px;
    border: 3px solid #e5e7eb;
    border-top-color: #2b579a;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

/* Scroll target highlight animation - for AI search result navigation */
@keyframes scrollTargetPulse {
    0% {
        background-color: rgba(250, 204, 21, 0.5) !important;
        outline: 3px solid rgba(250, 204, 21, 0.8);
        outline-offset: 2px;
    }

    70% {
        background-color: rgba(250, 204, 21, 0.3) !important;
        outline: 2px solid rgba(250, 204, 21, 0.5);
        outline-offset: 1px;
    }

    100% {
        background-color: transparent !important;
        outline: none;
        outline-offset: 0;
    }
}

.scroll-target-highlight {
    animation: scrollTargetPulse 3s ease-out forwards !important;
    border-radius: 2px;
}